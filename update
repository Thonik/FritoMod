#!/bin/bash
PATH=/bin:/usr/bin

get_file_list() {
    find * -name "*.lua" ! -name 'run-*' -print0 | xargs -0 ./get-requires | grep -v -e'^#';
}

update_files() {
    echo '<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/ ..\FrameXML\UI.xsd">'
    for f in `get_file_list | grep $*`; do
        f=`basename $f | sed -e 's#/#\\\\#g'`
        echo '<Script file="'$f'"/>'
    done;
    echo "</Ui>"
}

update_files -v -e'^labs' -e'^libs' -e'^wow' -e'^tests' >files.xml
update_files -e'^tests' >tests/files.xml
update_files -e'^labs' >labs/files.xml
